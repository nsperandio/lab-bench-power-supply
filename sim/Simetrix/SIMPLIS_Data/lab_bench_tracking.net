* C:\Users\nicol\Documents\Projects\lab-bench-power-supply\sim\Simetrix\lab_bench_tracking.wxsch
*#SIMETRIX
.node_map Isen_lin 130
.node_map Vdd 133
.node_map Isen 128
.node_map Vdrive 136
.node_map Islope 132
.node_map Vlink 124
.node_map G_H 125
.node_map G_L 129
.node_map Vsen_buck 123
.node_map CLK 131
.node_map G_SW 126
.node_map Vsen_lin 127
.node_map Vref 135
.node_map Iref 134
*.ac DEC 100 1k 1Meg
.print
+ ALL
.options
+ PSP_NPT=50001
+ POP_ITRMAX=20
+ POP_USE_TRAN_SNAPSHOT
+ POP_OUTPUT_CYCLES=5
+ SNAPSHOT_INTVL=0
+ SNAPSHOT_NPT=11
+ MIN_AVG_TOPOLOGY_DUR=1a
+ AVG_TOPOLOGY_DUR_MEASUREMENT_WINDOW=128
*.pop TRIG_GATE={TRIG_GATE} TRIG_COND=0_TO_1 MAX_PERIOD=6u CONVERGENCE=1p CYCLES_BEFORE_LAUNCH=40 TD_RUN_AFTER_POP_FAILS=-1
.tran 60m 0


C1 60 0 100n
C2 60 61 47u
C3 124 0 4.7u
C5 127 0 10p
C6 95 94 100n
C7 97 96 100n
C9 92 91 2.4n
E2 125 126 76 0 1
E3 129 0 90 0 1
X$H2 128 0 63 124 H2$TP_CCVS vars: gain=1
.subckt H2$TP_CCVS 1 2 3 4
.node_map P 1
.node_map N 2
.node_map CP 3
.node_map CN 4
H1 1 2 V1 {gain}
V1 3 4 0
.ends
X$H3 130 0 64 127 H3$TP_CCVS vars: gain=1
.subckt H3$TP_CCVS 1 2 3 4
.node_map P 1
.node_map N 2
.node_map CP 3
.node_map CN 4
H1 1 2 V1 {gain}
V1 3 4 0
.ends
L1 59 60 10n
L2 126 62 47u
.PRINT V(#Vlink)
.PRINT V(#Vsen_buck)
.GRAPH "db(:#Vlink/:#Vsen_buck)" Curvelabel="Gain" nowarn=true yunit="dB" complete=True analysis="ac" ylog=lin xlog=auto  ydelta=20 persistence=-1 colourname=Probe1_bode_color    axisname=bodemag order=1    userid=Probe1$GAIN. MeasureSpec="Gain\sCrossover\sFrequency\s(dB\sPlot)|0|0|0|0!Gain\sMargin\s(dB\sPlot)|0|0|0|0"
.post_process probe_measure Probe1$GAIN. Gain\sCrossover\sFrequency\s(dB\sPlot)|0|0|0|0!Gain\sMargin\s(dB\sPlot)|0|0|0|0
.GRAPH "ph(:#Vlink/:#Vsen_buck)" Curvelabel="Phase" nowarn=true yunit="degrees" complete=True analysis="ac" ylog=lin xlog=auto  ydelta=45 persistence=-1 colourname=Probe1_bode_color   axistype=grid axisname=bodephase order=0    userid=Probe1$PHASE. MeasureSpec="Phase\sMargin\s(Phase\sPlot)|0|0|0|0"
.post_process probe_measure Probe1$PHASE. Phase\sMargin\s(Phase\sPlot)|0|0|0|0
X$Q1 60 125 126 PWR_NMOS_SPICE_V3 vars: USER_COSS=3.0368n CDG_NSEG=0 RDSon=850.947u VCGS1=1 MAX_ROFF=100Meg QCDS1=106.288n VD_PEAK=35 VGSON=10 ID_PEAK=5 LIMIT_MAX_ROFF=1 VCDS0=0 TEMP=25 BD_NSEG=4 LEVEL=1 ROFF=100Meg QCGS0=0 VT0=1.80389 HYSTWD=180.389m VGS2=2.80389 VCGS0=0 ID2=46.341 VCDS1=35 RG=809.845m KP1=333.333m KP2=1 REV_BIAS=0 REV_BIAS_SEGS=2 VD0=-10.001k IBD0=-1 VD1=-10k IBD1=0 VD2=627.507m IBD2=0 VD3=690.637m USE_EXTRACTED=1 IBD3=1.54366 VD4=719.911m IBD4=5 CGS_NSEG=1 QCGS1=6.64552n LABEL='USER_LABEL' CDS_NSEG=1 QCDS0=0 DEVICE='BSC010N04LS_L1' USER_DIODE_FWD_RES=8.46961m USER_RDSON=850.947u USER_ROFF=100Meg USER_VT0=1.80389 USER_HYSTWD=180.389m USER_DIODE_FWD_VOLTAGE=677.563m USER_CGS=6.64552n USER_RG=809.845m REF='Q1'

X$Q2 126 129 0 PWR_NMOS_SPICE_V3 vars: USER_COSS=3.0368n CDG_NSEG=0 RDSon=850.947u VCGS1=1 MAX_ROFF=100Meg QCDS1=106.288n VD_PEAK=35 VGSON=10 ID_PEAK=5 LIMIT_MAX_ROFF=1 VCDS0=0 TEMP=25 BD_NSEG=4 LEVEL=1 ROFF=100Meg QCGS0=0 VT0=1.80389 HYSTWD=180.389m VGS2=2.80389 VCGS0=0 ID2=46.341 VCDS1=35 RG=809.845m KP1=333.333m KP2=1 REV_BIAS=0 REV_BIAS_SEGS=2 VD0=-10.001k IBD0=-1 VD1=-10k IBD1=0 VD2=627.507m IBD2=0 VD3=690.637m USE_EXTRACTED=1 IBD3=1.54366 VD4=719.911m IBD4=5 CGS_NSEG=1 QCGS1=6.64552n LABEL='USER_LABEL' CDS_NSEG=1 QCDS0=0 DEVICE='BSC010N04LS_L1' USER_DIODE_FWD_RES=8.46961m USER_RDSON=850.947u USER_ROFF=100Meg USER_VT0=1.80389 USER_HYSTWD=180.389m USER_DIODE_FWD_VOLTAGE=677.563m USER_CGS=6.64552n USER_RG=809.845m REF='Q2'

X$Q3 68 102 103 NPN_SPICE_V3 vars: USE_EXTRACTED=1 DEVICE='BC337' LABEL='USER_LABEL' LEVEL=2 ICE_PEAK=50m ON_AT_T0=0 USER_ICE_PEAK=50m USER_BR=10 USER_BF=280 USER_RC=50m USER_RE=200m USER_IS=8.52f USER_RB=0 IS=8.52f RB=0 BR=10 NF=1 BF=280 RC=50m RE=200m REF='Q3'
X$Q4 68 101 103 NPN_SPICE_V3 vars: USE_EXTRACTED=1 DEVICE='BC337' LABEL='USER_LABEL' LEVEL=2 ICE_PEAK=50m ON_AT_T0=0 USER_ICE_PEAK=50m USER_BR=10 USER_BF=280 USER_RC=50m USER_RE=200m USER_IS=8.52f USER_RB=0 IS=8.52f RB=0 BR=10 NF=1 BF=280 RC=50m RE=200m REF='Q4'
X$Q5 65 69 0 NPN_SPICE_V3 vars: USE_EXTRACTED=1 DEVICE='BC337' LABEL='USER_LABEL' LEVEL=2 ICE_PEAK=50m ON_AT_T0=0 USER_ICE_PEAK=50m USER_BR=10 USER_BF=280 USER_RC=50m USER_RE=200m USER_IS=8.52f USER_RB=0 IS=8.52f RB=0 BR=10 NF=1 BF=280 RC=50m RE=200m REF='Q5'
X$Q6 64 65 124 PNP_SPICE_V3 vars: USE_EXTRACTED=1 DEVICE='TIP42C' LABEL='USER_LABEL' LEVEL=2 ICE_PEAK=5 ON_AT_T0=0 USER_ICE_PEAK=5 USER_BR=10 USER_BF=150 USER_RC=20m USER_RE=80m USER_IS=74.2f USER_RB=0 IS=74.2f RB=0 BR=10 NF=1 BF=150 RC=20m RE=80m REF='Q6'
R1 59 58 100m
R10 100 130 10k
R12 94 135 1K
R13 103 0 10
R14 101 95 22k
R15 102 97 22k
R16 124 68 47k
R17 124 65 100
R19 127 0 10
R2 61 0 10m
R23 86 92 8.2k
R24 91 93 10k
R25 93 0 10k
R26 69 68 10k
R27 123 93 177k
R3 63 62 10m
R5 99 127 10k
R6 127 66 10
R9 96 134 1K
X$S1 66 0 67 0 SIMPLIS_VC_SWITCH vars: 
X$U1 75 83 0 131 81 SIMPLIS_DIGI1_SRLATCH_Y vars: IC=0  RIN=10Meg ROUT=10 TH=2.5 HYSTWD=1 VOL=0 VOH=5  OUT_DELAY=2p SET_RESET_LEVEL=1 GNDREF='Y'  DOM='R' 
X$U2 78 82 0 75 SIMPLIS_DIGI1_BUF_Y vars: IC=0 RIN=10Meg ROUT=10 HYSTWD=1 VOL=0 VOH=5 DELAY=100n TH=2.5
X$U3 76 79 0 75 78 SIMPLIS_DIGI1_AND2_Y vars: NumInv=0 IC=0 RIN=10Meg ROUT=10 HYSTWD=1 VOL=0 VOH=10 DELAY=2p TH=2.5
X$U4 88 90 0 78 75 SIMPLIS_DIGI1_OR2_Y vars: NumInv=0 IC=0 RIN=10Meg ROUT=10 HYSTWD=1 VOL=0 VOH=10 DELAY=2p TH=2.5
X$U7 81 87 0 80 86 SIMPLIS_DIGI1_COMP_Y vars: IC=0 RIN=10Meg ROUT=10 HYSTWD=2M VOL=0 VOH=5 DELAY=2p
X$U8 80 0 128 132 SIMPLIS_SUMMER2_BB vars: K1=1 K2=1
+ OFFSET=0 USE_RIN=0 RIN=10k
X$V1 131 0 PUL_SOURCE vars: _V1=0 _V2=5 _FREQ=200k _DELAY=0 _DRATIOx100=1 _T_RISE=5n _T_FALL=5n _DAMP_COEF=0 _PWIDTH=45n _OFF_UNTIL_DELAY=0 _IDLE_IN_POP=0 _USEPHASE=0 _PHASE=0 _SHOWPARAMS=0
V13 135 0 13
V14 98 0 800m
V2 58 0 35
X$V3 132 0 SAW_SOURCE vars: _V1=0 _V2=660m _FREQ=200k _DELAY=0 _DRATIOx100=100 _T_RISE=5u _T_FALL=0 _DAMP_COEF=0 _PWIDTH=0 _OFF_UNTIL_DELAY=0 _IDLE_IN_POP=0 _USEPHASE=0 _PHASE=0 _SHOWPARAMS=0
V4 136 0 10
X$V5 67 0 STEP_SOURCE vars: _V1=0 _V2=5 _FREQ=10k _DELAY=10m _DRATIOx100=50 _T_RISE=50n _T_FALL=50n _DAMP_COEF=0 _PWIDTH=50u _OFF_UNTIL_DELAY=0 _IDLE_IN_POP=1 _USEPHASE=0 _PHASE=10m _SHOWPARAMS=0
V6 123 124 AC 1
V7 133 0 40
V9 134 0 5
X2 131 72 PERIODIC_OP vars: VREF=2.5 VOL=0 VOH=5 HYSTWD=2 DIVIDE_BY_2=0 IC=0 DELAY=0 TRIG_COND='0_TO_1'

X3 100 134 133 0 97 PARAM_OPAMP vars: A0=100k
+ CMRR=100k
+ GBW=1e6
+ IB=100n
+ IBOS=1n
+ IO_SNK_MAX=5m
+ IO_SRC_MAX=5m
+ IQ=0.001
+ LEVEL=2
+ PSRR=100k
+ RIN=1meg
+ ROUT=100
+ RO_AC=50
+ SR_NEG=1e6
+ SR_POS=1e6
+ VDIFF_NEG=0
+ VDIFF_POS=0
+ VOS=0
X4 99 135 133 0 95 PARAM_OPAMP vars: A0=100k
+ CMRR=100k
+ GBW=1e6
+ IB=100n
+ IBOS=1n
+ IO_SNK_MAX=5m
+ IO_SRC_MAX=5m
+ IQ=0.001
+ LEVEL=2
+ PSRR=100k
+ RIN=1meg
+ ROUT=100
+ RO_AC=50
+ SR_NEG=1e6
+ SR_POS=1e6
+ VDIFF_NEG=0
+ VDIFF_POS=0
+ VOS=0
X5 98 91 133 0 86 PARAM_OPAMP vars: A0=100k
+ CMRR=100k
+ GBW=1Meg
+ IB=100n
+ IBOS=1n
+ IO_SNK_MAX=5m
+ IO_SRC_MAX=5m
+ IQ=1m
+ LEVEL=2
+ PSRR=100k
+ RIN=1Meg
+ ROUT=100
+ RO_AC=50
+ SR_NEG=1Meg
+ SR_POS=1Meg
+ VDIFF_NEG=0
+ VDIFF_POS=0
+ VOS=0

.end
